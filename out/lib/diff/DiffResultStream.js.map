{"version":3,"sources":["../../../src/lib/diff/DiffResultStream.js"],"names":["DiffResultStream","constructor","options","filePath","logger","processErrorMessage","file","toString","processChunk","diffItem","handleErrors","Good","done","write","state","text","nodeId","value","path"],"mappings":";;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;AAEA;;;;AAIe,MAAMA,gBAAN,+BAA2C;;AAGxD;;;;;AAKAC,cAAYC,UAAU,EAAtB,EAA0B;AACxB;;AAEA,UAAMC,WAAWD,QAAQC,QAAR,IAAoB,UAArC;;AAEA;;;;AAIA,SAAKC,MAAL,GAAc,2BAAkBD,QAAlB,CAAd;AACD;;AAED;;;;;AAKAE,sBAAoBC,IAApB,EAA0B;AACxB,WAAQ,yDAAwDA,KAAKC,QAAL,EAAgB,EAAhF;AACD;;AAGD;;;;;;;;AAQAC,eAAaC,QAAb,EAAuBC,YAAvB,EAAqC;AACnCA,iBAAa,IAAb,EAAmB,uBAAYC,IAA/B,EAAqCC,QAAQ;AAC3C,WAAKR,MAAL,CAAYS,KAAZ,CAAmB,GAAEJ,SAASK,KAAT,CAAeC,IAAK,GAAvB,GACf,UAASN,SAASO,MAAT,CAAgBC,KAAM,IADhB,GAEf,gBAAe,mBAAQR,SAASS,IAAjB,CAAuB,IAFzC;;AAKAN;AACD,KAPD;AAQD;AA/CuD;kBAArCZ,gB","file":"DiffResultStream.js","sourcesContent":["import { StatusCodes } from 'node-opcua';\nimport { createWriteStream } from 'fs';\nimport { dirname } from 'path';\nimport QueueStream from '../stream/QueueStream';\n\n/**\n * A stream checks if the given {@link NodeId}s exist on the atvise server or on\n * the filesystem, depending on the stream direction\n */\nexport default class DiffResultStream extends QueueStream {\n\n\n  /**\n   * Creates a new DiffItemStream.\n   * @param {Object} The options to use.\n   * @param {String|Path|Buffer} [options.filePath] The diff files path.\n   */\n  constructor(options = {}) {\n    super();\n\n    const filePath = options.filePath || 'diff.log';\n\n    /**\n     * The output write stream to create the logfile\n     * @type {Stream}\n     */\n    this.logger = createWriteStream(filePath);\n  }\n\n  /**\n   * Returns an error message specifically for the given mapping item.\n   * @param {DiffFile} file The diff file to create the error message for.\n   * @return {String} The specific error message.\n   */\n  processErrorMessage(file) {\n    return `DiffStream#processErrorMessage: Error processing item ${file.toString()}`;\n  }\n\n\n  /**\n   * Diffs the given {AtviseFile} with the corresponding atvise server resource or\n   * file systsem resource.\n   * @param {DiffItem} diffItem The diffItem to process\n   * @param {function(err: Error, statusCode: node-opcua~StatusCodes, onSuccess: function)}\n   * handleErrors The error handler to call. See {@link QueueStream#processChunk} for details.\n   */\n\n  processChunk(diffItem, handleErrors) {\n    handleErrors(null, StatusCodes.Good, done => {\n      this.logger.write(`${diffItem.state.text} ` +\n        `nodeId=${diffItem.nodeId.value}, ` +\n        `nodeFilePath=${dirname(diffItem.path)}\\n`\n      );\n\n      done();\n    });\n  }\n}\n\n"]}