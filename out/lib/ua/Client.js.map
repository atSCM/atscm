{"version":3,"sources":["../../../src/lib/ua/Client.js"],"names":["Client","create","client","requestedSessionTimeout","keepSessionAlive","Promise","resolve","reject","endpoint","host","port","opc","setTimeout","Error","connect","err","message"],"mappings":";;;;;;AAAA;;AACA;;;;;;AAEA;;;AAGe,MAAMA,MAAN,CAAa;;AAE1B;;;;;AAKA,SAAOC,MAAP,GAAgB;AACd,UAAMC,SAAS,2BAAgB;AAC7BC,+BAAyB,MADI;AAE7BC,wBAAkB;AAFW,KAAhB,CAAf;;AAKA,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,YAAMC,WAAY,aAAY,wBAAcC,IAAK,IAAG,wBAAcC,IAAd,CAAmBC,GAAI,EAA3E;;AAEAC,iBAAW,MAAML,OACf,IAAIM,KAAJ,CAAW,wBAAuBL,QAAS,wBAA3C,CADe,CAAjB,EAEG,IAFH;;AAIAN,aAAOY,OAAP,CAAeN,QAAf,EAAyBO,OAAO;AAC9B,YAAIA,GAAJ,EAAS;AACPR,iBAAO,IAAIM,KAAJ,CAAW,wBAAuBL,QAAS,KAAIO,IAAIC,OAAQ,EAA3D,CAAP;AACD,SAFD,MAEO;AACLV,kBAAQJ,MAAR;AACD;AACF,OAND;AAOD,KAdM,CAAP;AAeD;;AA5ByB;kBAAPF,M","file":"Client.js","sourcesContent":["import { OPCUAClient } from 'node-opcua';\nimport ProjectConfig from '../../config/ProjectConfig';\n\n/**\n * A wrapper around {@link node-opcua~OPCUAClient} used to connect to atvise server.\n */\nexport default class Client {\n\n  /**\n   * Creates and connects a new instance of {@link node-opcua~OPCUAClient}.\n   * @return {Promise<node-opcua~OPCUAClient, Error>} Fulfilled with an already connected\n   * {@link node-opcua~OPCUAClient} instance, rejected if an error occured.\n   */\n  static create() {\n    const client = new OPCUAClient({\n      requestedSessionTimeout: 600000,\n      keepSessionAlive: true,\n    });\n\n    return new Promise((resolve, reject) => {\n      const endpoint = `opc.tcp://${ProjectConfig.host}:${ProjectConfig.port.opc}`;\n\n      setTimeout(() => reject(\n        new Error(`Unable to connect to ${endpoint}: Connection timed out`)\n      ), 5000);\n\n      client.connect(endpoint, err => {\n        if (err) {\n          reject(new Error(`Unable to connect to ${endpoint}: ${err.message}`));\n        } else {\n          resolve(client);\n        }\n      });\n    });\n  }\n\n}\n"]}